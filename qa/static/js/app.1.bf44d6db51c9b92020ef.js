(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{155:function(e,t,r){"use strict";(function(e){var n,s=r(1),o=r(323),i=r(209);function a(){return s.createElement("div",{className:i.pageLoading},s.createElement("div",{className:i.spinBox},s.createElement(o.ClipLoader,{className:i.spin,sizeUnit:"px",size:66,color:"#586663",loading:!0})))}(n=r(17).enterModule)&&n(e);const c=a;var u,p;t.a=c,u=r(17).default,p=r(17).leaveModule,u&&(u.register(a,"PageLoading","C:/project/react/test/ts-react-webpack/src/components/PageLoading/index.tsx"),u.register(c,"default","C:/project/react/test/ts-react-webpack/src/components/PageLoading/index.tsx"),p(e))}).call(this,r(46)(e))},198:function(e,t,r){"use strict";(function(e){var n,s=r(2),o=r(3),i=r(74),a=r(40),c=r(54),u=r(45),p=r(26),d=r(69);(n=r(17).enterModule)&&n(e);var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editorState=null,t.setEditorState=function(e){t.editorState=e},t.resetEditorState=function(){Object(o.runInAction)(function(){t.editorState=null})},t.sendMessage=function(e,r){return s.b(t,void 0,Promise,function(){return s.e(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),void 0,1!==r?[3,2]:[4,this.api.single.messagesWritten(e)];case 1:return t.sent(),[3,4];case 2:return[4,this.api.group.groupWritten(e)];case 3:t.sent(),t.label=4;case 4:return[3,6];case 5:return t.sent(),[3,6];case 6:return[2]}})})},t.messagesImgMsg=function(e){return s.b(t,void 0,void 0,function(){var t;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),(t=new FormData).append("userid",p.a.usersIndex.id),1===d.a.chatType.conversationType?t.append("friendid",e.friendid):t.append("groupid",e.groupid),t.append("file",e.file),1!==d.a.chatType.conversationType?[3,2]:[4,this.api.single.messagesImgMsg(t)];case 1:return r.sent(),[3,4];case 2:return[4,this.api.group.groupImgMsg(t)];case 3:r.sent(),r.label=4;case 4:return[3,6];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.login=function(e){return s.b(t,void 0,Promise,function(){var t;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.auth.login(e)];case 1:return t=r.sent(),Object(c.d)(u.a.TOKEN,t.token),localStorage.setItem(u.b.USERINFO,JSON.stringify(t)),a.routerStore.replace("/"),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t}return s.d(t,e),s.c([o.observable],t.prototype,"editorState",void 0),s.c([o.action],t.prototype,"setEditorState",void 0),s.c([o.action],t.prototype,"resetEditorState",void 0),s.c([o.action],t.prototype,"sendMessage",void 0),s.c([o.action],t.prototype,"messagesImgMsg",void 0),s.c([o.action],t.prototype,"login",void 0),t}(i.b);const g=new l;var f,h;t.a=g,f=r(17).default,h=r(17).leaveModule,f&&(f.register(l,"MessageStore","C:/project/react/test/ts-react-webpack/src/store/messageStore/index.ts"),f.register(g,"default","C:/project/react/test/ts-react-webpack/src/store/messageStore/index.ts"),h(e))}).call(this,r(46)(e))},209:function(e,t,r){e.exports={pageLoading:"ZbrATjg_tt8MPYxcomz9w","spin-box":"FuSzEOu-G_dWN0ku_6k0x",spinBox:"FuSzEOu-G_dWN0ku_6k0x",spin:"_2xn6ZFnNUmfGKjYts-fqD4"}},21:function(e,t,r){"use strict";(function(e){var n,s,o=r(2),i=r(197),a=r.n(i),c=r(449),u=r(107),p=r.n(u),d=(r(290),r(54));(n=r(17).enterModule)&&n(e),function(e){e[e.LOGICERROR=0]="LOGICERROR",e[e.TIMEOUTERROR=1]="TIMEOUTERROR",e[e.NETWORKERROR=2]="NETWORKERROR"}(s||(s={}));var l=[2018,401,402,403,1004],g={baseURL:"https://m.kaixinliao.com/api/"},f={},h=["get","post","put","delete"],v=null,b=function(e){return e.result||e.data||{}};h.forEach(function(e){f[e]=function(t,r,n){var i={method:e,url:t,baseURL:n||g.baseURL,headers:{SIGN:""+Object(d.c)().sign}},u=a.a.create(g);return u.interceptors.request.use(function(e){var t={ts:Date.now()/1e3};return e.params=o.a({},e.params,t),e},function(e){return Promise.reject(e)}),u.interceptors.response.use(function(e){var t=null;if("object"==typeof e.data&&2018===e.data.code){var r={msg:e.data.msg,type:s[s.LOGICERROR],config:e.config},n=JSON.parse(localStorage.getItem("userInfo"));Math.round((new Date).getTime()),n.date;return window.clearTimeout(v),v=window.setTimeout(function(){location.replace("/#/login")},0),Promise.reject(r)}if("object"==typeof e.data&&1004===e.data.code){r={msg:e.data.msg,type:s[s.LOGICERROR],config:e.config};var o=JSON.parse(localStorage.getItem("userInfo")).date;Math.round((new Date).getTime());return window.clearTimeout(v),v=window.setTimeout(function(){location.replace("/#/login")},0),Promise.reject(r)}if("object"!=typeof e.data||200!==e.data.code){r={msg:e.data.msg,type:s[s.LOGICERROR],config:e.config};return Promise.reject(r)}return t=e.data,b(t)},function(e){if(l.includes(e.response.status))return p.a.destroy(),p.a.error("用户认证失败! 请登录重试..."),window.clearTimeout(v),void(v=window.setTimeout(function(){location.replace("/#/login")},300));var t={msg:e.response.statusText||e.message||"网络故障",type:/^timeout of/.test(e.message)?s[s.TIMEOUTERROR]:s[s.NETWORKERROR],config:e.config};return Promise.reject(t)}),"get"===e?i.params=r:r instanceof FormData?i.data=r:i.data=c.stringify(r),i.startTime=new Date,u.request(i).then(function(e){return e}).catch(function(e){return p.a.destroy(),p.a.error(e.response||e.msg||e.stack||"未知错误"),i.url.includes("autoScript.set")?Promise.resolve({err:e}):Promise.reject({err:e,stack:e.msg||e.stack||""})})}});const I=f;var m,y;t.a=I,m=r(17).default,y=r(17).leaveModule,m&&(m.register(s,"HTTPERROR","C:/project/react/test/ts-react-webpack/src/services/http.ts"),m.register(l,"TOKENERROR","C:/project/react/test/ts-react-webpack/src/services/http.ts"),m.register(g,"DEFAULTCONFIG","C:/project/react/test/ts-react-webpack/src/services/http.ts"),m.register(f,"http","C:/project/react/test/ts-react-webpack/src/services/http.ts"),m.register(h,"methods","C:/project/react/test/ts-react-webpack/src/services/http.ts"),m.register(v,"authTimer","C:/project/react/test/ts-react-webpack/src/services/http.ts"),m.register(b,"resFormat","C:/project/react/test/ts-react-webpack/src/services/http.ts"),m.register(I,"default","C:/project/react/test/ts-react-webpack/src/services/http.ts"),y(e))}).call(this,r(46)(e))},210:function(e,t,r){e.exports={centered:"_1Pb_YPy676dVNBrGJ2B1fC",emoji:"_1J6Ao3Ne1sQxLR_8CECkqI",title:"_2JaRclWo2z-t0tnIVfZYvK"}},26:function(e,t,r){"use strict";(function(e){var n,s=r(2),o=r(3),i=r(74),a=r(54),c=r(40),u=r(69);(n=r(17).enterModule)&&n(e);var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.usersIndex={id:"",nickname:"",phone:"",portraitUri:"",role:""},t.usersBlacklist=[],t.friendshipAll=[],t.groupsGroupUser=[],t.usersGroups=[],t.friendApplyList=[],t.friendStatus=!1,t.friendid="",t.addFriendStatus=!1,t.imgUrl="",t.base="",t.isUserGroupEnd=!1,t.refreshusersIndex=function(){return s.b(t,void 0,void 0,function(){var e,t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.user.usersIndex(Object(a.c)().id)];case 1:return e=r.sent(),Object(o.runInAction)("SET_USER_Index",function(){t.usersIndex=e}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.refreshusersBlacklist=function(){return s.b(t,void 0,void 0,function(){var e,t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.user.usersBlacklist({userid:Object(a.c)().id})];case 1:return e=r.sent(),Object(o.runInAction)("SET_USER_Blacklist",function(){t.usersBlacklist=e}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.goBack=function(){history.back()},t.refreshfriendshipAll=function(){return s.b(t,void 0,void 0,function(){var e,t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.user.friendshipAll({userid:Object(a.c)().id})];case 1:return e=r.sent(),Object(o.runInAction)("SET_USER_FriendshipAll",function(){var r=[];e.forEach(function(e){"1"===e.status&&r.push(e)}),t.friendshipAll=r,localStorage.setItem("friendshipAll",JSON.stringify(t.friendshipAll.slice()))}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.refreshusersGroups=function(){return s.b(t,void 0,void 0,function(){var e,t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.usersGroups({userid:Object(a.c)().id})];case 1:return e=r.sent(),this.usersGroups=[],Object(o.runInAction)("SET_USER_usersGroups",function(){for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];t.usersGroups.push(s.a({role:n.role},n.group))}t.isUserGroupEnd=!0,localStorage.setItem("usersGroups",JSON.stringify(t.usersGroups.slice()))}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.refreshfriendApplyList=function(){return s.b(t,void 0,void 0,function(){var e,t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.user.friendApplyList({userid:Object(a.c)().id})];case 1:return e=r.sent(),Object(o.runInAction)("SET_USER_friendApplyList",function(){t.friendApplyList=e}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.getUsers=function(){return s.b(t,void 0,void 0,function(){var e,t,r,n,i,c,u,p,d=this;return s.e(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),e=this.api.user,t=Object(a.c)().id,[4,Promise.all([e.usersIndex(t),e.usersBlacklist({userid:t}),e.friendshipAll({userid:t}),this.api.group.usersGroups({userid:t}),e.friendApplyList({userid:t})])];case 1:return r=l.sent(),n=r[0],i=r[1],c=r[2],u=r[3],p=r[4],Object(o.runInAction)("SET_USER_LIST",function(){d.usersIndex=n,d.usersBlacklist=i;var e=[];for(var t in c.forEach(function(t){"1"===t.status&&e.push(t)}),d.friendshipAll=e,localStorage.setItem("friendshipAll",JSON.stringify(d.friendshipAll.slice())),u)if(u.hasOwnProperty(t)){var r=u[t];d.usersGroups.push(s.a({role:r.role},r.group))}localStorage.setItem("usersGroups",JSON.stringify(d.usersGroups.slice())),d.friendApplyList=p}),[3,3];case 2:return l.sent(),[3,3];case 3:return[2]}})})},t.loadfriendslist=function(){return s.b(t,void 0,void 0,function(){var e,t,r,n=this;return s.e(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),e=this.api.user,t=Object(a.c)().id,[4,e.friendshipAll({userid:t})];case 1:return r=s.sent(),Object(o.runInAction)("SET_FRIENDSLIST",function(){n.friendshipAll=r}),[3,3];case 2:return s.sent(),[3,3];case 3:return[2]}})})},t.resetfriendStatus=function(){Object(o.runInAction)("SET_FRIENDSSTATUS",function(){t.friendStatus=!1,t.addFriendStatus=!1,t.friendid="",t.friendIndex=null})},t.uploadImg=function(e){return s.b(t,void 0,void 0,function(){var t,r,n=this;return s.e(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),this.imgUrl="",this.base="",(t=new FormData).append("file",e.file),[4,this.api.user.uploadImg(t)];case 1:return r=s.sent(),Object(o.runInAction)(function(){n.imgUrl=r.imgUrl,n.base=r.base}),[3,3];case 2:return s.sent(),[3,3];case 3:return[2]}})})},t.changeState=function(){return s.b(t,void 0,void 0,function(){var e=this;return s.e(this,function(t){try{Object(o.runInAction)("SET_FRIENDS",function(){e.friendStatus=!e.friendStatus})}catch(e){Object(o.runInAction)("SET_FRIENDS",function(){})}return[2]})})},t.addGagUser=function(e){return s.b(t,void 0,void 0,function(){return s.e(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.api.group.groupsaddGagUser(e)];case 1:return t.sent(),Object(o.runInAction)("addGagUser",function(){}),[3,3];case 2:return t.sent(),Object(o.runInAction)("addGagUser",function(){}),[3,3];case 3:return[2]}})})},t.checkMessage=function(){return s.b(t,void 0,void 0,function(){var e;return s.e(this,function(t){switch(t.label){case 0:return e=1===u.a.chatType.conversationType?1:2,[4,this.api.user.checkMessage({userid:this.usersIndex.id,status:e,toformid:u.a.chatType.targetId})];case 1:return[2,t.sent()]}})})},t.removeFriend=function(e){return s.b(t,void 0,void 0,function(){var t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.user.removeFriend(e)];case 1:return r.sent(),Object(o.runInAction)("removeFriend",function(){t.$message.success("删除好友成功!")}),[3,3];case 2:return r.sent(),Object(o.runInAction)("removeFriend",function(){}),[3,3];case 3:return[2]}})})},t.goOneKeyGroup=function(){return s.b(t,void 0,void 0,function(){return s.e(this,function(e){try{c.routerStore.history.push("/OneKeyGroup")}catch(e){c.routerStore.history.goBack()}return[2]})})},t.groupsQuit=function(e){return s.b(t,void 0,void 0,function(){var t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupsQuit(e)];case 1:return r.sent(),Object(o.runInAction)("groupsQuit",function(){c.routerStore.history.goBack(),u.a.deleteConvList(3,u.a.chatType.targetId),t.$message.success("退出群组成功!")}),[3,3];case 2:return r.sent(),Object(o.runInAction)("groupsQuit",function(){}),[3,3];case 3:return[2]}})})},t.gotoPush=function(e){try{c.routerStore.history.push(e)}catch(e){}},t.groupsGroupUsers=function(){return s.b(t,void 0,void 0,function(){var e,t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupsGroupUser({userid:this.usersIndex.id,groupid:u.a.chatType.targetId})];case 1:return e=r.sent(),Object(o.runInAction)("groupsGroupUsers",function(){t.groupsGroupUser=e.user}),[3,3];case 2:return r.sent(),Object(o.runInAction)("groupsGroupUsers",function(){}),[3,3];case 3:return[2]}})})},t.groupsDismiss=function(e){return s.b(t,void 0,void 0,function(){var t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupsDismiss(e)];case 1:return r.sent(),Object(o.runInAction)("groupsDismiss",function(){c.routerStore.history.goBack(),u.a.deleteConvList(3,u.a.chatType.targetId),t.$message.success("退出群组成功!")}),[3,3];case 2:return r.sent(),Object(o.runInAction)("groupsDismiss",function(){}),[3,3];case 3:return[2]}})})},t.groupsJoin=function(e){return s.b(t,void 0,void 0,function(){var t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupsJoin(e)];case 1:return r.sent(),Object(o.runInAction)("GROUP_JOIN",function(){t.$message.success("邀请成功!"),t.refreshusersGroups(),c.routerStore.push("/")}),[3,3];case 2:return r.sent(),Object(o.runInAction)("GROUP_CREATE",function(){}),[3,3];case 3:return[2]}})})},t.groupsCreate=function(e){return s.b(t,void 0,void 0,function(){var t,r=this;return s.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.group.groupsCreate(e)];case 1:return t=n.sent(),Object(o.runInAction)("GROUP_CREATE",function(){r.groupid=t,r.$message.success("创建成功!"),r.refreshusersGroups()}),[3,3];case 2:return n.sent(),Object(o.runInAction)("GROUP_CREATE",function(){}),[3,3];case 3:return[2]}})})},t.queryFriendship=function(e){return s.b(t,void 0,void 0,function(){var t,r=this;return s.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.api.auth.queryFriendship(e)];case 1:return t=n.sent(),[4,this.api.auth.confirmFriend({userid:this.usersIndex.id,friendid:t.id})];case 2:return n.sent(),Object(o.runInAction)("SET_FRIENDS",function(){r.friendStatus=!0,r.friendid=t.id,r.friendIndex=t}),[3,4];case 3:return n.sent(),Object(o.runInAction)("SET_FRIENDSSTATUS",function(){r.friendStatus=!1}),[3,4];case 4:return[2]}})})},t.addFriendship=function(e){return s.b(t,void 0,void 0,function(){var t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.auth.addFriendship(e)];case 1:return r.sent(),Object(o.runInAction)("SET_ADDSTATUS",function(){t.addFriendStatus=!0}),[3,3];case 2:return r.sent(),Object(o.runInAction)("SET_ADDSTATUS",function(){t.addFriendStatus=!1}),[3,3];case 3:return[2]}})})},t}return s.d(t,e),s.c([o.observable],t.prototype,"usersIndex",void 0),s.c([o.observable],t.prototype,"usersBlacklist",void 0),s.c([o.observable],t.prototype,"friendshipAll",void 0),s.c([o.observable],t.prototype,"groupsGroupUser",void 0),s.c([o.observable],t.prototype,"usersGroups",void 0),s.c([o.observable],t.prototype,"friendApplyList",void 0),s.c([o.observable],t.prototype,"friendStatus",void 0),s.c([o.observable],t.prototype,"friendIndex",void 0),s.c([o.observable],t.prototype,"friendid",void 0),s.c([o.observable],t.prototype,"addFriendStatus",void 0),s.c([o.observable],t.prototype,"groupid",void 0),s.c([o.observable],t.prototype,"imgUrl",void 0),s.c([o.observable],t.prototype,"base",void 0),s.c([o.observable],t.prototype,"isUserGroupEnd",void 0),s.c([o.action],t.prototype,"refreshusersIndex",void 0),s.c([o.action],t.prototype,"refreshusersBlacklist",void 0),s.c([o.action],t.prototype,"goBack",void 0),s.c([o.action],t.prototype,"refreshfriendshipAll",void 0),s.c([o.action],t.prototype,"refreshusersGroups",void 0),s.c([o.action],t.prototype,"refreshfriendApplyList",void 0),s.c([o.action],t.prototype,"getUsers",void 0),s.c([o.action],t.prototype,"loadfriendslist",void 0),s.c([o.action],t.prototype,"resetfriendStatus",void 0),s.c([o.action],t.prototype,"uploadImg",void 0),s.c([o.action],t.prototype,"changeState",void 0),s.c([o.action],t.prototype,"addGagUser",void 0),s.c([o.action],t.prototype,"checkMessage",void 0),s.c([o.action],t.prototype,"removeFriend",void 0),s.c([o.action],t.prototype,"goOneKeyGroup",void 0),s.c([o.action],t.prototype,"groupsQuit",void 0),s.c([o.action],t.prototype,"gotoPush",void 0),s.c([o.action],t.prototype,"groupsGroupUsers",void 0),s.c([o.action],t.prototype,"groupsDismiss",void 0),s.c([o.action],t.prototype,"groupsJoin",void 0),s.c([o.action],t.prototype,"groupsCreate",void 0),s.c([o.action],t.prototype,"queryFriendship",void 0),s.c([o.action],t.prototype,"addFriendship",void 0),t}(i.b);const d=new p;var l,g;t.a=d,l=r(17).default,g=r(17).leaveModule,l&&(l.register(p,"UserStore","C:/project/react/test/ts-react-webpack/src/store/userStore/index.ts"),l.register(d,"default","C:/project/react/test/ts-react-webpack/src/store/userStore/index.ts"),g(e))}).call(this,r(46)(e))},275:function(e,t,r){"use strict";r.r(t);var n=r(329);r.d(t,"auth",function(){return n.a});var s=r(350);r.d(t,"user",function(){return s.a});var o=r(351);r.d(t,"group",function(){return o.a});var i=r(352);r.d(t,"single",function(){return i.a})},327:function(e,t,r){"use strict";(function(e){var n,s=r(1),o=r(210);(n=r(17).enterModule)&&n(e);var i=function(){return s.createElement("div",{className:o.centered},s.createElement("div",{className:o.emoji},"😭"),s.createElement("p",{className:o.title},"糟糕!"),s.createElement("p",null,"该页面似乎飞往其他星球了."))};const a=i;var c,u;t.a=a,c=r(17).default,u=r(17).leaveModule,c&&(c.register(i,"Error","C:/project/react/test/ts-react-webpack/src/components/Error/index.tsx"),c.register(a,"default","C:/project/react/test/ts-react-webpack/src/components/Error/index.tsx"),u(e))}).call(this,r(46)(e))},329:function(e,t,r){"use strict";(function(e){var n,s=r(21);(n=r(17).enterModule)&&n(e);const o={login:function(e){return s.a.post("/login/login",e||{})},refreshSign:function(e){return s.a.post("/login/refreshSign",e||{})},register:function(e){return s.a.post("/login/register",e||{})},resetPassword:function(e){return s.a.post("/login/reset_password",e||{})},verifyCode:function(e){return s.a.post("/login/verify_code",e||{})},sendCode:function(e){return s.a.post("/login/send_code",e||{})},logout:function(e){return s.a.post("/login/logout",e||{})},refresh:function(e){return s.a.post("/users/refresh",e||{})},addblacklist:function(e){return s.a.post("/users/addblacklist",e||{})},removeblacklist:function(e){return s.a.post("/users/removeblacklist",e||{})},queryFriendship:function(e){return s.a.post("/friendship/queryFriendship",e||{})},confirmFriend:function(e){return s.a.post("/friendship/confirmFriend",e||{})},addFriendship:function(e){return s.a.post("/friendship/addFriendship",e||{})}};var i,a;t.a=o,i=r(17).default,a=r(17).leaveModule,i&&(i.register(o,"default","C:/project/react/test/ts-react-webpack/src/services/api/auth.ts"),a(e))}).call(this,r(46)(e))},350:function(e,t,r){"use strict";(function(e){var n,s=r(21);(n=r(17).enterModule)&&n(e);const o={usersIndex:function(e){return s.a.get("/users/index/"+e,{})},friendshipAll:function(e){return s.a.post("/friendship/all",e||{})},usersBlacklist:function(e){return s.a.post("/users/blacklist",e||{})},friendApplyList:function(e){return s.a.post("/friendship/friendApplyList",e||{})},toExamineFriend:function(e){return s.a.post("/friendship/toExamineFriend",e||{})},removeFriend:function(e){return s.a.post("/friendship/removeFriend",e||{})},uploadImg:function(e){return s.a.post("/Messages/uploadImg",e||{})},checkMessage:function(e){return s.a.post("/Messages/checkMessage",e||{})}};var i,a;t.a=o,i=r(17).default,a=r(17).leaveModule,i&&(i.register(o,"default","C:/project/react/test/ts-react-webpack/src/services/api/user.ts"),a(e))}).call(this,r(46)(e))},351:function(e,t,r){"use strict";(function(e){var n,s=r(21);(n=r(17).enterModule)&&n(e);const o={usersGroups:function(e){return s.a.post("/users/groups",e||{})},groupsMembers:function(e){return s.a.get("/groups/members/"+e,{})},groupWritten:function(e){return s.a.post("/messages/groupWritten",e||{})},groupImgMsg:function(e){return s.a.post("/messages/groupImgMsg",e||{})},groupFileMsg:function(e){return s.a.post("/messages/groupFileMsg",e||{})},groupsCreate:function(e){return s.a.post("/groups/create",e||{})},groupsJoin:function(e){return s.a.post("/groups/join",e||{})},groupsQuit:function(e){return s.a.post("/groups/quit",e||{})},groupsDismiss:function(e){return s.a.post("/groups/dismiss",e||{})},groupDismiss:function(e){return s.a.post("/group/dismiss",e||{})},groupsRefresh:function(e){return s.a.post("/groups/refresh",e||{})},groupsGroupUser:function(e){return s.a.post("/groups/groupUser",e||{})},groupsRegusers:function(e){return s.a.post("/groups/regusers",e||{})},groupsGroupInfo:function(e){return s.a.get("/groups/groupInfo/"+e,{})},groupsaddGagUser:function(e){return s.a.post("/Groups/addGagUser",e||{})},groupsrollBackGagUser:function(e){return s.a.post("/Groups/rollBackGagUser",e||{})},groupslisGagUser:function(e){return s.a.post("/Groups/lisGagUser",e||{})},groupssetGroupRole:function(e){return s.a.post("/Groups/setGroupRole",e||{})},groupsgroupRole:function(e){return s.a.post("/Groups/groupRole",e||{})}};var i,a;t.a=o,i=r(17).default,a=r(17).leaveModule,i&&(i.register(o,"default","C:/project/react/test/ts-react-webpack/src/services/api/group.ts"),a(e))}).call(this,r(46)(e))},352:function(e,t,r){"use strict";(function(e){var n,s=r(21);(n=r(17).enterModule)&&n(e);const o={usersIndex:function(e){return s.a.get("/users/index/"+e,{})},messagesWritten:function(e){return s.a.post("/messages/written",e||{})},messagesImgMsg:function(e){return s.a.post("/messages/imgMsg",e||{})},messagesFileMsg:function(e){return s.a.post("/messages/fileMsg",e||{})}};var i,a;t.a=o,i=r(17).default,a=r(17).leaveModule,i&&(i.register(o,"default","C:/project/react/test/ts-react-webpack/src/services/api/single.ts"),a(e))}).call(this,r(46)(e))},353:function(e,t,r){"use strict";(function(e){var n,s=r(2),o=r(3),i=r(74),a=r(45);(n=r(17).enterModule)&&n(e);var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sideBarCollapsed="1"===localStorage.getItem(a.b.SIDE_BAR_COLLAPSED),t.sideBarTheme=localStorage.getItem(a.b.SIDE_BAR_THEME)||"light",t.navOpenKeys=JSON.parse(localStorage.getItem(a.b.NAV_OPEN_KEYS))||[],t.toggleSideBarCollapsed=function(){t.sideBarCollapsed=!t.sideBarCollapsed,localStorage.setItem(a.b.SIDE_BAR_COLLAPSED,t.sideBarCollapsed?"1":"0")},t.changeSiderTheme=function(e){t.sideBarTheme=e,localStorage.setItem(a.b.SIDE_BAR_THEME,e)},t.setOpenKeys=function(e){t.navOpenKeys=e,localStorage.setItem(a.b.NAV_OPEN_KEYS,JSON.stringify(e))},t}return s.d(t,e),s.c([o.observable],t.prototype,"sideBarCollapsed",void 0),s.c([o.observable],t.prototype,"sideBarTheme",void 0),s.c([o.observable],t.prototype,"navOpenKeys",void 0),s.c([o.action],t.prototype,"toggleSideBarCollapsed",void 0),s.c([o.action],t.prototype,"changeSiderTheme",void 0),s.c([o.action],t.prototype,"setOpenKeys",void 0),t}(i.b);const u=new c;var p,d;t.a=u,p=r(17).default,d=r(17).leaveModule,p&&(p.register(c,"GlobalStore","C:/project/react/test/ts-react-webpack/src/store/globalStore/index.ts"),p.register(u,"default","C:/project/react/test/ts-react-webpack/src/store/globalStore/index.ts"),d(e))}).call(this,r(46)(e))},354:function(e,t,r){"use strict";(function(e){var n,s=r(2),o=r(3),i=r(74),a=r(40),c=r(54),u=r(45),p=r(197),d=r.n(p),l=r(198),g=r(26);(n=r(17).enterModule)&&n(e);var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userInfo=null,t.login=function(e){return s.b(t,void 0,Promise,function(){var t,r,n=this;return s.e(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.api.auth.login(e)];case 1:return t=i.sent(),Object(o.runInAction)("SET_USERINFO",function(){n.userInfo=t}),Object(c.d)(u.a.TOKEN,t.token),r=Math.round((new Date).getTime()),localStorage.setItem(u.b.USERINFO,JSON.stringify(s.a({},t,{date:r}))),a.routerStore.replace("/"),[3,3];case 2:return i.sent(),[3,3];case 3:return[2]}})})},t.refreshSign=function(e){return s.b(t,void 0,Promise,function(){return s.e(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.api.auth.refreshSign(e)];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}})})},t.register=function(e){return s.b(t,void 0,Promise,function(){return s.e(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.api.auth.register(e)];case 1:return t.sent(),this.$message.success("注册成功"),a.routerStore.replace("/login"),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}})})},t.resetPassword=function(e){return s.b(t,void 0,Promise,function(){return s.e(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.api.auth.resetPassword(e)];case 1:return t.sent(),this.$message.success("重置密码成功"),a.routerStore.replace("/login"),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}})})},t.verifyCode=function(e){return s.b(t,void 0,Promise,function(){var t,r=this;return s.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.auth.verifyCode(e)];case 1:return t=n.sent(),this.$message.success("校验成功"),Object(o.runInAction)("SET_USERINFO",function(){r.verification_token=t.verification_token}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}})})},t.sendCode=function(e){return s.b(t,void 0,Promise,function(){return s.e(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.api.auth.sendCode(e)];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}})})},t.uploadImg=function(){return s.b(t,void 0,void 0,function(){return s.e(this,function(e){return d.a.get("https://picsum.photos/200/300/?random",{responseType:"blob"}).then(function(e){var t=new File(e.data,"1.jpg");l.a.messagesImgMsg({friendid:"9",file:t})}),[2]})})},t.logout=function(){return s.b(t,void 0,void 0,function(){return s.e(this,function(e){switch(e.label){case 0:Object(c.a)(u.a.TOKEN),localStorage.removeItem(u.b.USERINFO),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.api.auth.logout({userid:g.a.usersIndex.id})];case 2:return e.sent(),a.routerStore.replace("/login"),location.reload(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}})})},t.initUserInfo=function(){var e=localStorage.getItem(u.b.USERINFO);if(!e)throw new Error("no local userinfo!!");var r=JSON.parse(e);return t.userInfo=r,r},t}return s.d(t,e),s.c([o.observable],t.prototype,"userInfo",void 0),s.c([o.observable],t.prototype,"verification_token",void 0),s.c([o.action],t.prototype,"login",void 0),s.c([o.action],t.prototype,"refreshSign",void 0),s.c([o.action],t.prototype,"register",void 0),s.c([o.action],t.prototype,"resetPassword",void 0),s.c([o.action],t.prototype,"verifyCode",void 0),s.c([o.action],t.prototype,"sendCode",void 0),s.c([o.action],t.prototype,"uploadImg",void 0),s.c([o.action],t.prototype,"logout",void 0),s.c([o.action],t.prototype,"initUserInfo",void 0),t}(i.b);const h=new f;var v,b;t.a=h,v=r(17).default,b=r(17).leaveModule,v&&(v.register(f,"AuthStore","C:/project/react/test/ts-react-webpack/src/store/authStore/index.ts"),v.register(h,"default","C:/project/react/test/ts-react-webpack/src/store/authStore/index.ts"),b(e))}).call(this,r(46)(e))},40:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"routerStore",function(){return l});var n=r(201),s=r(353);r.d(t,"globalStore",function(){return s.a});var o=r(354);r.d(t,"authStore",function(){return o.a});var i=r(26);r.d(t,"userStore",function(){return i.a});var a=r(69);r.d(t,"rongStore",function(){return a.a});var c,u=r(198);r.d(t,"messageStore",function(){return u.a}),(c=r(17).enterModule)&&c(e);var p,d,l=new n.RouterStore;p=r(17).default,d=r(17).leaveModule,p&&(p.register(l,"routerStore","C:/project/react/test/ts-react-webpack/src/store/index.ts"),d(e))}.call(this,r(46)(e))},445:function(e,t,r){"use strict";(function(e){var n,s=r(2),o=r(1),i=r(17),a=r(154),c=r.n(a),u=r(1229),p=r(1230),d=r(159),l=r(446),g=r(155),f=r(327),h=r(448);(n=r(17).enterModule)&&n(e);var v=c()({loader:function(){return Promise.all([r.e(0),r.e(2)]).then(r.bind(null,1248))},loading:g.a}),b=c()({loader:function(){return Promise.all([r.e(0),r.e(3)]).then(r.bind(null,1251))},loading:g.a}),I=c()({loader:function(){return Promise.all([r.e(0),r.e(4)]).then(r.bind(null,1252))},loading:g.a}),m=c()({loader:function(){return Promise.all([r.e(0),r.e(4)]).then(r.bind(null,1253))},loading:g.a}),y=function(e){return o.createElement("div",{className:l.appWrapper},e.children)},C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s.d(t,e),t.prototype.render=function(){return o.createElement(y,null,o.createElement(u.a,null,o.createElement(p.a,null,o.createElement(d.a,{exact:!0,path:"/login",component:b}),o.createElement(d.a,{exact:!0,path:"/register",component:I}),o.createElement(d.a,{exact:!0,path:"/forgetpwd",component:m}),o.createElement(h.a,{path:"/",component:v}),o.createElement(d.a,{component:f.a}))))},t}(o.Component);const S=Object(i.hot)(e)(C);var M,E;t.a=S,M=r(17).default,E=r(17).leaveModule,M&&(M.register(v,"Home","C:/project/react/test/ts-react-webpack/src/containers/shared/App/index.tsx"),M.register(b,"Login","C:/project/react/test/ts-react-webpack/src/containers/shared/App/index.tsx"),M.register(I,"register","C:/project/react/test/ts-react-webpack/src/containers/shared/App/index.tsx"),M.register(m,"forgetpwd","C:/project/react/test/ts-react-webpack/src/containers/shared/App/index.tsx"),M.register(y,"AppWrapper","C:/project/react/test/ts-react-webpack/src/containers/shared/App/index.tsx"),M.register(C,"AppRouter","C:/project/react/test/ts-react-webpack/src/containers/shared/App/index.tsx"),M.register(S,"default","C:/project/react/test/ts-react-webpack/src/containers/shared/App/index.tsx"),E(e))}).call(this,r(46)(e))},446:function(e,t,r){e.exports={appWrapper:"_3Ndwn1769-PHbenrbYaD4B"}},448:function(e,t,r){"use strict";(function(e){var n,s=r(2),o=r(1),i=r(135),a=r(159),c=r(74),u=r(54),p=r(45);(n=r(17).enterModule)&&n(e);var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gotoLogin=function(){t.props.routerStore.history.replace("/login")},t.checkLocalUserInfo=function(){var e=Object(u.b)(p.a.TOKEN);if(!e)return t.gotoLogin();var r=t.props,n=r.userInfo,s=r.initUserInfo,o=r.initSdk,i=(r.getUsers,r.refreshusersIndex),a=r.refreshusersBlacklist,c=r.refreshfriendshipAll,d=r.refreshusersGroups,l=r.refreshfriendApplyList;if(i(),a(),c(),d(),l(),o(),!n)try{if(s().token!==e)throw new Error("cookie 上储存的token与localStorage 上储存的token不一致!")}catch(e){t.gotoLogin()}},t}return s.d(t,e),t.prototype.componentDidMount=function(){this.checkLocalUserInfo()},t.prototype.render=function(){var e=this.props,t=e.component,r=s.f(e,["component"]);return o.createElement(a.a,s.a({},r,{render:function(e){return o.createElement(t,s.a({},r))}}))},t=s.c([Object(i.b)(function(e){var t=e.routerStore,r=e.authStore,n=e.rongStore,s=e.userStore,o=n.initSdk;return{routerStore:t,userInfo:r.userInfo,initUserInfo:r.initUserInfo,initSdk:o,getUsers:s.getUsers,refreshusersIndex:s.refreshusersIndex,refreshusersBlacklist:s.refreshusersBlacklist,refreshfriendshipAll:s.refreshfriendshipAll,refreshusersGroups:s.refreshusersGroups,refreshfriendApplyList:s.refreshfriendApplyList}}),i.c],t)}(c.a);const l=d;var g,f;t.a=l,g=r(17).default,f=r(17).leaveModule,g&&(g.register(d,"PrivateRoute","C:/project/react/test/ts-react-webpack/src/containers/shared/PrivateRoute/index.tsx"),g.register(l,"default","C:/project/react/test/ts-react-webpack/src/containers/shared/PrivateRoute/index.tsx"),f(e))}).call(this,r(46)(e))},45:function(e,t,r){"use strict";(function(e){var n,s,o;r.d(t,"a",function(){return s}),r.d(t,"b",function(){return o}),(n=r(17).enterModule)&&n(e),function(e){e.TOKEN="token",e.SIGN="sign"}(s||(s={})),function(e){e.USERINFO="userInfo",e.NAV_OPEN_KEYS="navOpenKeys",e.SIDE_BAR_THEME="sideBarTheme",e.SIDE_BAR_COLLAPSED="sideBarCollapsed"}(o||(o={}));var i,a,c=["user","admin"];i=r(17).default,a=r(17).leaveModule,i&&(i.register(s,"COOKIE_KEYS","C:/project/react/test/ts-react-webpack/src/constants/index.ts"),i.register(o,"LOCALSTORAGE_KEYS","C:/project/react/test/ts-react-webpack/src/constants/index.ts"),i.register(c,"LOGIN_CATEGORY","C:/project/react/test/ts-react-webpack/src/constants/index.ts"),a(e))}).call(this,r(46)(e))},457:function(e,t){},54:function(e,t,r){"use strict";(function(e){r.d(t,"d",function(){return a}),r.d(t,"b",function(){return c}),r.d(t,"a",function(){return u}),r.d(t,"c",function(){return g});var n,s,o,i=r(450);function a(e,t,r){void 0===r&&(r=365);var n=new Date;n.setDate(n.getDate()+r),document.cookie=e+"="+escape(t)+";expires="+n.toUTCString()}function c(e){if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!==t){t=t+e.length+1;var r=document.cookie.indexOf(";",t);return-1===r&&(r=document.cookie.length),unescape(document.cookie.substring(t,r))}}return""}function u(e){a(e,"")}function p(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(t);return null!==r?decodeURI(r[2]):null}function d(e,t,r){if(void 0===r&&(r="key"),!(e instanceof Array))return null;var n=e.filter(function(e){return e[r]===t});return n.length?n[0]:null}function l(e,t,r,n){void 0===t&&(t="id"),void 0===r&&(r="pid"),void 0===n&&(n="children");var s=Object(i.cloneDeep)(e),o=[],a={};return s.forEach(function(e,r){a[s[r][t]]=s[r]}),s.forEach(function(e){var t=a[e[r]];t?(t[n]||(t[n]=[]),t[n].push(e)):o.push(e)}),o}function g(){var e=JSON.parse(localStorage.getItem("userInfo"));return e||""}(n=r(17).enterModule)&&n(e),s=r(17).default,o=r(17).leaveModule,s&&(s.register(a,"setCookie","C:/project/react/test/ts-react-webpack/src/utils/index.ts"),s.register(c,"getCookie","C:/project/react/test/ts-react-webpack/src/utils/index.ts"),s.register(u,"clearCookie","C:/project/react/test/ts-react-webpack/src/utils/index.ts"),s.register(p,"queryURL","C:/project/react/test/ts-react-webpack/src/utils/index.ts"),s.register(d,"queryArray","C:/project/react/test/ts-react-webpack/src/utils/index.ts"),s.register(l,"arrayToTree","C:/project/react/test/ts-react-webpack/src/utils/index.ts"),s.register(g,"getSign","C:/project/react/test/ts-react-webpack/src/utils/index.ts"),o(e))}).call(this,r(46)(e))},562:function(e,t,r){r(563),e.exports=r(679)},679:function(e,t,r){"use strict";r.r(t),function(e){var t,n=r(2),s=(r(682),r(1)),o=r(15),i=r(135),a=r(3),c=r(444),u=r.n(c),p=r(201),d=r(282),l=r(445),g=r(40);(t=r(17).enterModule)&&t(e);var f=u()(),h=Object(p.syncHistoryWithStore)(f,g.routerStore);Object(a.configure)({enforceActions:"observed"});var v,b,I=function(e){o.render(s.createElement(i.a,n.a({},g),s.createElement(d.a,{history:h},s.createElement(e,null))),document.getElementById("app"))};I(l.a),v=r(17).default,b=r(17).leaveModule,v&&(v.register(f,"hashHistory","C:/project/react/test/ts-react-webpack/src/index.tsx"),v.register(h,"history","C:/project/react/test/ts-react-webpack/src/index.tsx"),v.register(I,"render","C:/project/react/test/ts-react-webpack/src/index.tsx"),b(e))}.call(this,r(46)(e))},682:function(e,t,r){},69:function(e,t,r){"use strict";(function(e){var n,s=r(2),o=r(3),i=r(74),a=r(115),c=r.n(a),u=(r(328),r(468),r(45)),p=r(26),d=r(281),l=r(40);(n=r(17).enterModule)&&n(e),d.a.plugin(r(1225));var g={title:"hero schema",version:0,description:"describes a simple hero",type:"object",properties:{name:{type:"string",primary:!0},secret:{type:"string",encrypted:!0}},required:["secret"]},f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userInfo=null,t.ConversationsList=[],t.MessagesList=[],t.chatType=null,t.unreadMessageCount=0,t.unreadCount=0,t.timestamp=0,t.hasMsg=!0,t.initEnd=!1,t.createDb=function(){return s.b(t,void 0,void 0,function(){var e;return s.e(this,function(t){switch(t.label){case 0:return e=this,[4,d.a.create({name:"heroesdb",adapter:"localstorage",password:"myLongAndStupidPassword",multiInstance:!0})];case 1:return e.db=t.sent(),[4,this.db.collection({name:"heroes",schema:g})];case 2:return t.sent(),this.db.heroes.insert({name:"111Bob",secret:"sd1111"}),this.db.heroes.find().where("name").gt(18).exec(),this.db.heroes.find().exec().then(function(e){}),[2]}})})},t.initSdk=function(){var e=localStorage.getItem(u.b.USERINFO);if(e){var r=JSON.parse(e);t.init(r.appkey),t.setConnectionStatusListener(),t.setOnReceiveMessageListener(),t.connect(r.token),RongIMLib.RongIMEmoji.init()}},t.init=function(e){RongIMLib.RongIMClient.init(e,null,{})},t.setConnectionStatusListener=function(){RongIMLib.RongIMClient.setConnectionStatusListener({onChanged:function(e){switch(e){case RongIMLib.ConnectionStatus.CONNECTED:t.GetConversationsList(),t.getTotalUnreadCount(),Object(o.runInAction)(function(){t.initEnd=!0});break;case RongIMLib.ConnectionStatus.CONNECTING:break;case RongIMLib.ConnectionStatus.DISCONNECTED:t.reconnect();break;case RongIMLib.ConnectionStatus.KICKED_OFFLINE_BY_OTHER_CLIENT:t.$message.error("其他设备登录"),l.routerStore.replace("/login");break;case RongIMLib.ConnectionStatus.DOMAIN_INCORRECT:break;case RongIMLib.ConnectionStatus.NETWORK_UNAVAILABLE:t.reconnect()}}})},t.setOnReceiveMessageListener=function(){try{RongIMLib.RongIMClient.setOnReceiveMessageListener({onReceived:function(e){return s.b(t,void 0,void 0,function(){var t,r,n,i,a,u,d,l,g,f,h,v=this;return s.e(this,function(b){switch(b.label){case 0:if(e.offLineMessage)return[2];switch(e.objectName){case"RC:TxtMsg":return[3,1];case"RC:ImgMsg":case"RC:FileMsg":return[3,2];case"RC:InfoNtf":return[3,13];case"RC:ImgTextMsg":return[3,14];case"RC:VcMsg":return[3,15];case"RC:LBSMsg":return[3,16];case"RC:SightMsg":return[3,17];case"RC:ProfileNtf":return[3,18];case"RC:CmdNtf":return[3,19];case"RC:GrpNtf":return[3,20];case"RC:ReadNtf":return[3,21];case"RC:ContactNtf":return[3,22]}return[3,23];case 1:b.label=2;case 2:switch(a=this.ConversationsList.slice().findIndex(function(t){return t.targetId===e.targetId}),u=-1!==a?this.ConversationsList[a].unreadMessageCount:0,e.messageDirection){case 1:return[3,3];case 2:return[3,4]}return[3,11];case 3:switch(e.conversationType){case 1:if(g=JSON.parse(localStorage.getItem("friendshipAll")),n=g.findIndex(function(t){return t.user.id===e.targetId}),i={conversationType:e.conversationType,content:e.content,messageDirection:e.messageDirection,senderUserId:e.senderUserId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:0},r=s.a({},i,{portraitUri:p.a.usersIndex.portraitUri,nickname:p.a.usersIndex.nickname}),-1!==a){if(t=s.a({},i,{portraitUri:g[n].user.portraitUri,nickname:g[n].user.nickname}),this.refreshConversationsList(t,!1),this.chatType&&this.chatType.targetId!==e.targetId)return[2];this.pullMessage(r)}else this.api.user.usersIndex(e.targetId).then(function(n){t=s.a({},i,{portraitUri:n.portraitUri,nickname:n.nickname}),v.refreshConversationsList(t,!1),v.chatType&&v.chatType.targetId!==e.targetId||v.pullMessage(r)});break;case 3:if(f=JSON.parse(localStorage.getItem("usersGroups")),n=f.findIndex(function(t){return t.id===e.targetId}),i={conversationType:e.conversationType,content:e.content,messageDirection:e.messageDirection,senderUserId:e.senderUserId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:0},r=s.a({},i,{portraitUri:p.a.usersIndex.portraitUri,nickname:p.a.usersIndex.nickname}),-1!==a){if(t=s.a({},i,{portraitUri:f[n].portraitUri,nickname:f[n].name}),this.refreshConversationsList(t,!1),this.chatType&&this.chatType.targetId!==e.targetId)return[2];this.pullMessage(r)}else this.api.group.groupsGroupInfo(p.a.usersIndex.id).then(function(n){t=s.a({},i,{portraitUri:n.group.portraitUri,nickname:n.group.name}),v.refreshConversationsList(t,!1),v.chatType&&v.chatType.targetId!==e.targetId||v.pullMessage(r)})}return[3,12];case 4:switch(Object(o.runInAction)(function(){v.unreadCount++}),e.conversationType){case 1:return[3,5];case 3:return[3,6]}return[3,9];case 5:if(l=JSON.parse(localStorage.getItem("friendshipAll")),g=l.find(function(t){return t.user.id===e.targetId}),i={conversationType:e.conversationType,content:e.content,messageDirection:e.messageDirection,senderUserId:e.senderUserId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:++u},g){if(r=s.a({},i,{portraitUri:g.user.portraitUri,nickname:g.user.nickname}),t=s.a({},i,{portraitUri:g.user.portraitUri,nickname:g.user.nickname}),this.refreshConversationsList(t,!1),this.chatType&&this.chatType.targetId!==e.targetId)return[2];this.pullMessage(r)}else this.api.user.usersIndex(e.targetId).then(function(n){r=s.a({},i,{portraitUri:n.portraitUri,nickname:n.nickname}),t=s.a({},i,{portraitUri:n.portraitUri,nickname:n.nickname}),v.refreshConversationsList(t,!1),v.chatType&&v.chatType.targetId!==e.targetId||v.pullMessage(r)});return[3,10];case 6:return f=JSON.parse(localStorage.getItem("usersGroups")),h=f.find(function(t){return t.id===e.targetId}),(d=JSON.parse(localStorage.getItem("groupsMembers"+e.targetId)))?[3,8]:[4,this.groupsMember(e.targetId)];case 7:b.sent(),d=JSON.parse(localStorage.getItem("groupsMembers"+e.targetId)),b.label=8;case 8:if(i={conversationType:e.conversationType,content:e.content,messageDirection:e.messageDirection,senderUserId:e.senderUserId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:++u},d.forEach(function(t){t.id===e.senderUserId&&(r=s.a({},i,{portraitUri:t.portraitUri,nickname:t.nickname}))}),h){if(t=s.a({},i,{portraitUri:h.portraitUri,nickname:h.name}),this.refreshConversationsList(t,!1),this.chatType&&this.chatType.targetId!==e.targetId)return[2];this.pullMessage(r)}else this.api.group.groupsGroupInfo(e.targetId).then(function(n){t=s.a({},i,{portraitUri:n.portraitUri,nickname:n.name}),v.refreshConversationsList(t,!1),v.chatType&&v.chatType.targetId!==e.targetId||v.pullMessage(r)});return[3,10];case 9:return[3,10];case 10:case 11:return[3,12];case 12:return[3,24];case 13:return e.conversationType,[3,24];case 14:case 15:case 16:case 17:case 18:case 19:return[3,24];case 20:switch(e.content.operation){case"Create":this.GetConversationsList()}return[3,24];case 21:return[3,24];case 22:switch(e.content.operation){case"Request":c.a.open({message:"您有一个新的待添加好友",description:"附加信息: "+e.content.message,duration:3}),p.a.refreshfriendApplyList();break;case"AcceptResponse":c.a.open({message:"接受好友",description:""+e.content.message,duration:3});break;case"RejectResponse":c.a.open({message:"拒绝好友",description:""+e.content.message,duration:3})}return[3,24];case 23:return[3,24];case 24:return[2]}})})}})}catch(e){t.$message.error("监听异常，返回登录页"),l.routerStore.replace("/login")}},t.connect=function(e){RongIMLib.RongIMClient.connect(e,{onSuccess:function(e){},onTokenIncorrect:function(){},onError:function(e){}})},t.GetConversationsList=function(){return RongIMLib.RongIMClient.getInstance().getConversationList({onSuccess:function(e){Object(o.runInAction)("RESET_CONVERLIST",function(){t.ConversationsList=[],t.unreadCount=0}),e.forEach(function(e){switch(e.objectName){case"RC:TxtMsg":case"RC:ImgMsg":case"RC:FileMsg":t.getUnreadCount({conversationType:e.conversationType,targetId:e.latestMessage.targetId});case"RC:InfoNtf":var r,n={conversationType:e.conversationType,content:e.latestMessage.content,messageDirection:e.latestMessage.messageDirection,senderUserId:e.latestMessage.senderUserId,targetId:e.targetId,sentTime:e.latestMessage.sentTime,unreadMessageCount:e.unreadMessageCount,messageId:e.latestMessage.messageId};switch(e.conversationType){case 1:t.api.single.usersIndex(e.targetId).then(function(e){r=Object.assign(n,{nickname:e.nickname},{portraitUri:e.portraitUri}),Object(o.runInAction)("SET_CONVLIST",function(){t.ConversationsList.push(r)})}).catch(function(r){t.deleteConvList(1,e.targetId)});break;case 3:t.api.group.groupsGroupInfo(e.targetId).then(function(e){r=Object.assign(n,{nickname:e.name},{portraitUri:e.portraitUri}),Object(o.runInAction)("SET_CONVLIST",function(){t.ConversationsList.push(r)})}).catch(function(r){t.deleteConvList(3,e.targetId)})}break;case"RC:ContactNtf":case"RC:ProfileNtf":case"RC:CmdNtf":case"RC:GrpNtf":case"RC:ReadNtf":case"RC:PSCmd":case"RC:CmdMsg":t.deleteConvList(e.conversationType,e.targetId)}})},onError:function(e){}},null,null,null),t.ConversationsList},t.sendTImgMessageSDK=function(e,r,n){return s.b(t,void 0,void 0,function(){var e,t,o,i=this;return s.e(this,function(a){return""===p.a.imgUrl||""===p.a.base?[2]:(e=new RongIMLib.ImageMessage({content:p.a.base,imageUri:p.a.imgUrl}),t=r||this.chatType.conversationType,o=n||this.chatType.targetId,RongIMLib.RongIMClient.getInstance().sendMessage(t,o,e,{onSuccess:function(e){var t=s.a({},e,{nickname:p.a.usersIndex.nickname,portraitUri:p.a.usersIndex.portraitUri});i.pushMessage(t)},onError:function(e,t){var r="";switch(e){case RongIMLib.ErrorCode.TIMEOUT:r="超时";break;case RongIMLib.ErrorCode.UNKNOWN:r="未知错误";break;case RongIMLib.ErrorCode.REJECTED_BY_BLACKLIST:r="在黑名单中，无法向对方发送消息";break;case RongIMLib.ErrorCode.NOT_IN_DISCUSSION:r="不在讨论组中";break;case RongIMLib.ErrorCode.NOT_IN_GROUP:r="不在群组中";break;case RongIMLib.ErrorCode.NOT_IN_CHATROOM:r="不在聊天室中"}i.$message.error("发送失败:  "+r),history.back()},onBefore:function(e){}}),[2])})})},t.sendTextMessageSDK=function(e,r,n){return s.b(t,void 0,void 0,function(){var t,o,i,a=this;return s.e(this,function(c){return t=new RongIMLib.TextMessage({content:e,extra:{nickname:p.a.usersIndex.nickname,portraitUri:p.a.usersIndex.portraitUri}}),o=r||this.chatType.conversationType,i=n||this.chatType.targetId,RongIMLib.RongIMClient.getInstance().sendMessage(o,i,t,{onSuccess:function(e){var t=s.a({},e,{nickname:p.a.usersIndex.nickname,portraitUri:p.a.usersIndex.portraitUri});a.pushMessage(t)},onError:function(e,t){var r="";switch(e){case RongIMLib.ErrorCode.TIMEOUT:r="超时";break;case RongIMLib.ErrorCode.UNKNOWN:r="未知错误";break;case RongIMLib.ErrorCode.REJECTED_BY_BLACKLIST:r="在黑名单中，无法向对方发送消息";break;case RongIMLib.ErrorCode.NOT_IN_DISCUSSION:r="不在讨论组中";break;case RongIMLib.ErrorCode.NOT_IN_GROUP:r="不在群组中";break;case RongIMLib.ErrorCode.NOT_IN_CHATROOM:r="不在聊天室中"}a.$message.error("发送失败:  "+r),history.back()},onBefore:function(e){}}),[2]})})},t.sendInforMessageSDK=function(e,r,n){return s.b(t,void 0,void 0,function(){var t,o,i,a=this;return s.e(this,function(c){return t=new RongIMLib.InformationNotificationMessage({message:e,extra:{nickname:p.a.usersIndex.nickname,portraitUri:p.a.usersIndex.portraitUri}}),o=r||this.chatType.conversationType,i=n||this.chatType.targetId,RongIMLib.RongIMClient.getInstance().sendMessage(o,i,t,{onSuccess:function(e){var t=s.a({},e,{nickname:p.a.usersIndex.nickname,portraitUri:p.a.usersIndex.portraitUri});a.pushMessage(t)},onError:function(e,t){var r="";switch(e){case RongIMLib.ErrorCode.TIMEOUT:r="超时";break;case RongIMLib.ErrorCode.UNKNOWN:r="未知错误";break;case RongIMLib.ErrorCode.REJECTED_BY_BLACKLIST:r="在黑名单中，无法向对方发送消息";break;case RongIMLib.ErrorCode.NOT_IN_DISCUSSION:r="不在讨论组中";break;case RongIMLib.ErrorCode.NOT_IN_GROUP:r="不在群组中";break;case RongIMLib.ErrorCode.NOT_IN_CHATROOM:r="不在聊天室中"}a.$message.error("发送失败:  "+r),history.back()},onBefore:function(e){}}),[2]})})},t.groupsMember=function(e){return s.b(t,void 0,void 0,function(){var t;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=[],[4,this.api.group.groupsMembers(e).then(function(r){r.forEach(function(r){t.push(s.a({srole:r.role,displayName:r.displayName,isgag:r.isgag},r.user)),localStorage.setItem("groupsMembers"+e,JSON.stringify(t))})})];case 1:return r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.groupsMembers=function(){return s.b(t,void 0,void 0,function(){var e=this;return s.e(this,function(t){try{p.a.usersGroups.forEach(function(t){e.groupsMember(t.id)})}catch(e){}return[2]})})},t.clearConversations=function(){return s.b(t,void 0,void 0,function(){var e=this;return s.e(this,function(t){return RongIMLib.RongIMClient.getInstance().clearConversations({onSuccess:function(){e.GetConversationsList()},onError:function(e){}}),[2]})})},t.groupsRegusers=function(e){return s.b(t,void 0,void 0,function(){var t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupsRegusers(e)];case 1:return r.sent(),Object(o.runInAction)("removegroupsRegusers",function(){t.$message.success("移除群员成功!")}),[3,3];case 2:return r.sent(),Object(o.runInAction)("removegroupsRegusers",function(){}),[3,3];case 3:return[2]}})})},t.getTotalUnreadCount=function(){return s.b(t,void 0,void 0,function(){var e=this;return s.e(this,function(t){return RongIMLib.RongIMClient.getInstance().getTotalUnreadCount({onSuccess:function(t){Object(o.runInAction)("SET_UNRENDCOUNT",function(){e.unreadCount=t})},onError:function(e){}}),[2]})})},t.resethasMsg=function(){t.hasMsg=!0,t.timestamp=0},t.historyMessage=function(e){RongIMLib.RongIMClient.getInstance().getHistoryMessages(t.chatType.conversationType,e,t.timestamp,20,{onSuccess:function(e,r){return s.b(t,void 0,void 0,function(){var t,n=this;return s.e(this,function(i){switch(i.label){case 0:return 0===e.length?[2]:(Object(o.runInAction)("SET_HASMSG",function(){n.hasMsg=r,n.timestamp=e[0].sentTime,n.MessagesList=[]}),1!==this.chatType.conversationType?[3,1]:(e.forEach(function(e){var t=s.a({},e,{nickname:2===e.messageDirection?n.chatType.nickname:p.a.usersIndex.nickname,portraitUri:2===e.messageDirection?n.chatType.portraitUri:p.a.usersIndex.portraitUri});Object(o.runInAction)("SET_MESSAGE",function(){n.MessagesList.unshift(t)})}),[3,5]));case 1:return(t=JSON.parse(localStorage.getItem("groupsMembers"+this.chatType.targetId)))?[3,3]:[4,this.groupsMember(this.chatType.targetId).then(function(){t=JSON.parse(localStorage.getItem("groupsMembers"+n.chatType.targetId))})];case 2:i.sent(),i.label=3;case 3:return[4,e.forEach(function(e){return s.b(n,void 0,void 0,function(){var r,n,i,a=this;return s.e(this,function(c){switch(c.label){case 0:return r={},1!==e.messageDirection?[3,1]:(r.nickname=p.a.usersIndex.nickname,r.portraitUri=p.a.usersIndex.portraitUri,[3,4]);case 1:return(n=t.find(function(t){return t.id===e.senderUserId}))?[3,3]:[4,this.api.user.usersIndex(e.senderUserId).then(function(e){r.nickname=e.nickname,r.portraitUri=e.portraitUri})];case 2:return c.sent(),[3,4];case 3:r.nickname=n.nickname,r.portraitUri=n.portraitUri,c.label=4;case 4:return i=s.a({},e,r),Object(o.runInAction)("SET_MESSAGE",function(){a.MessagesList.unshift(i)}),[2]}})})})];case 4:i.sent(),i.label=5;case 5:return[2]}})})},onError:function(e){t.$message.error("获取历史消息错误，返回登录页"),l.routerStore.replace("/login")}})},t.deleteConvList=function(e,t){RongIMLib.RongIMClient.getInstance().removeConversation(e,t,{onSuccess:function(e){},onError:function(e){}})},t.reduceUnreadCount=function(){var e=t.ConversationsList.slice().findIndex(function(e){return e.targetId===t.chatType.targetId});if(-1!==e){var r=t.ConversationsList[e].unreadMessageCount,n=s.a({},t.ConversationsList[e],{unreadMessageCount:0});t.ConversationsList.splice(e,1,n),t.unreadCount-=r}},t.clearUnreadCount=function(e){RongIMLib.RongIMClient.getInstance().clearUnreadCount(e.conversationType,e.targetId,{onSuccess:function(){},onError:function(e){}})},t.getUnreadCount=function(e){RongIMLib.RongIMClient.getInstance().getUnreadCount(e.conversationType,e.targetId,{onSuccess:function(e){Object(o.runInAction)(function(){t.unreadCount+=e})},onError:function(){}})},t.setChatType=function(e){t.chatType=e},t.resetMessage=function(){t.MessagesList=[]},t.resetConversationsList=function(){t.ConversationsList=[]},t.sendRecallMessage=function(e){var r=t.MessagesList.findIndex(function(t){return t.messageUId===e.messageUId});RongIMLib.RongIMClient.getInstance().sendRecallMessage(e,{onSuccess:function(e){t.sendInforMessageSDK(p.a.usersIndex.nickname+"撤回了一条消息"),Object(o.runInAction)(function(){t.MessagesList.splice(r,1)})},onError:function(e,t){},onBefore:function(e){}})},t.groupssetGroupRole=function(e){return s.b(t,void 0,void 0,function(){var t=this;return s.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupssetGroupRole(e)];case 1:return r.sent(),Object(o.runInAction)(function(){t.$message.success("设置群管理成功"),t.groupsMember(t.chatType.targetId),l.routerStore.history.goBack()}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.pullMessage=function(e){t.MessagesList.push(e)},t.pushMessage=function(e){t.MessagesList.push(e),t.refreshConversationsList(e,!0)},t.refreshConversationsList=function(e,r){var n,s=t.ConversationsList.findIndex(function(t){return t.targetId===e.targetId});n={conversationType:r?t.chatType.conversationType:e.conversationType,content:e.content,messageDirection:1,senderUserId:e.senderUserId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:r?0:e.unreadMessageCount,portraitUri:r?t.chatType.portraitUri:e.portraitUri,nickname:r?t.chatType.nickname:e.nickname},-1===s?t.ConversationsList.push(n):t.ConversationsList.splice(s,1,n)},t.disconnect=function(){RongIMLib.RongIMClient.getInstance().disconnect()},t.reconnect=function(){var e={onSuccess:function(e){t.$message.success("重新连接成功！")},onTokenIncorrect:function(){t.$message.error("token无效")},onError:function(e){}};RongIMLib.RongIMClient.reconnect(e,{auto:!0,url:"cdn.ronghub.com/RongIMLib-2.2.6.min.js",rate:[100,1e3,3e3,6e3,1e4]})},t}return s.d(t,e),Object.defineProperty(t.prototype,"getAllUnreadCount",{get:function(){return this.ConversationsList.reduce(function(e,t){return e+t.unreadMessageCount},0)},enumerable:!0,configurable:!0}),s.c([o.observable],t.prototype,"userInfo",void 0),s.c([o.observable],t.prototype,"ConversationsList",void 0),s.c([o.observable],t.prototype,"MessagesList",void 0),s.c([o.observable],t.prototype,"chatType",void 0),s.c([o.observable],t.prototype,"unreadMessageCount",void 0),s.c([o.observable],t.prototype,"unreadCount",void 0),s.c([o.observable],t.prototype,"timestamp",void 0),s.c([o.observable],t.prototype,"hasMsg",void 0),s.c([o.observable],t.prototype,"initEnd",void 0),s.c([o.observable],t.prototype,"db",void 0),s.c([o.action],t.prototype,"createDb",void 0),s.c([o.action],t.prototype,"initSdk",void 0),s.c([Object(o.action)("GET_CONVDATA")],t.prototype,"GetConversationsList",void 0),s.c([o.action],t.prototype,"sendTImgMessageSDK",void 0),s.c([o.action],t.prototype,"sendTextMessageSDK",void 0),s.c([o.action],t.prototype,"sendInforMessageSDK",void 0),s.c([o.action],t.prototype,"groupsMember",void 0),s.c([o.action],t.prototype,"groupsMembers",void 0),s.c([o.action],t.prototype,"clearConversations",void 0),s.c([o.action],t.prototype,"groupsRegusers",void 0),s.c([o.action],t.prototype,"getTotalUnreadCount",void 0),s.c([o.action],t.prototype,"resethasMsg",void 0),s.c([o.action],t.prototype,"historyMessage",void 0),s.c([o.action],t.prototype,"deleteConvList",void 0),s.c([o.action],t.prototype,"reduceUnreadCount",void 0),s.c([o.action],t.prototype,"clearUnreadCount",void 0),s.c([o.computed],t.prototype,"getAllUnreadCount",null),s.c([o.action],t.prototype,"getUnreadCount",void 0),s.c([o.action],t.prototype,"setChatType",void 0),s.c([o.action],t.prototype,"resetMessage",void 0),s.c([o.action],t.prototype,"resetConversationsList",void 0),s.c([o.action],t.prototype,"sendRecallMessage",void 0),s.c([o.action],t.prototype,"groupssetGroupRole",void 0),s.c([o.action],t.prototype,"pullMessage",void 0),s.c([o.action],t.prototype,"pushMessage",void 0),s.c([o.action],t.prototype,"refreshConversationsList",void 0),s.c([o.action],t.prototype,"disconnect",void 0),s.c([o.action],t.prototype,"reconnect",void 0),t}(i.b);const h=new f;var v,b;t.a=h,v=r(17).default,b=r(17).leaveModule,v&&(v.register(g,"mySchema","C:/project/react/test/ts-react-webpack/src/store/rongImStore/index.ts"),v.register(f,"RongStore","C:/project/react/test/ts-react-webpack/src/store/rongImStore/index.ts"),v.register(h,"default","C:/project/react/test/ts-react-webpack/src/store/rongImStore/index.ts"),b(e))}).call(this,r(46)(e))},74:function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return g}),r.d(t,"b",function(){return f});var n,s=r(2),o=r(1),i=r(107),a=r.n(i),c=(r(290),r(115)),u=r.n(c),p=(r(328),r(275));(n=r(17).enterModule)&&n(e);var d,l,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.api=p,t.$message=a.a,t.$notification=u.a,t}return s.d(t,e),t}(o.Component),f=function(){return function(){this.api=p,this.$message=a.a,this.$notification=u.a}}();d=r(17).default,l=r(17).leaveModule,d&&(d.register(g,"ComponentExt","C:/project/react/test/ts-react-webpack/src/utils/reactExt.tsx"),d.register(f,"StoreExt","C:/project/react/test/ts-react-webpack/src/utils/reactExt.tsx"),l(e))}).call(this,r(46)(e))},790:function(e,t){},815:function(e,t){},817:function(e,t){}},[[562,8,0]]]);